<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>You have an undirected graph G with <b>n</b> vertices and m edges.
The vertices are numbered 0 through <b>n</b>-1.
You are given the int <b>n</b>.
You are also given the vector &lt;int&gt;s <b>a</b> and <b>b</b>, each with m elements.
For each valid i, the graph G contains the edge between <b>a</b>[i] and <b>b</b>[i].
<br></br>
<br></br>
The graph G is guaranteed to have the following properties:
<ul>
<li>G is simple: there are no self-loops and no multiple edges.</li>
<li>G is connected: each vertex is reachable from each other vertex by following a sequence of edges.</li>
<li>The number of edges is between <b>n</b>+1 and <b>n</b>+5, inclusive.</li>
</ul>

An automorphism of a graph is an isomorphism between two copies of the graph.
Formally, an automorphism of a graph is a permutation p of {0, 1, ..., <b>n</b>-1} with the following property:
For each i and j, vertices i and j are connected by an edge if and only if vertices p[i] and p[j] are connected by an edge.
<br></br>
<br></br>
Compute the number of automorphisms of the given graph, and return that value modulo 10^9 + 7.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>AutomorphicGraph</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>int, vector &lt;int&gt;, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int count(int n, vector &lt;int&gt; a, vector &lt;int&gt; b)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>n</b> will be between 4 and 100, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>m will be between <b>n</b>+1 and <b>n</b>+5, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>a</b> and <b>b</b> will contain exactly m elements.</td></tr><tr><td align="center" valign="top">-</td><td>All elements in <b>a</b> and <b>b</b> will be between 0 and <b>n</b>-1, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>The graph G will be simple and connected.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>{0,0,0,0,1,1,1,2,2,3}</pre></td></tr><tr><td><pre>{1,2,3,4,2,3,4,3,4,4}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 120</pre></td></tr><tr><td><table><tr><td colspan="2">The graph is G5, so all 5! = 120 permutations are good.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>4</pre></td></tr><tr><td><pre>{0,0,0,2,2}</pre></td></tr><tr><td><pre>{1,2,3,1,3}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2">This time we have 4 permutations:
<ul>
<li>{0, 1, 2, 3}</li>
<li>{0, 3, 2, 1}</li>
<li>{2, 1, 0, 3}</li>
<li>{2, 3, 0, 1}</li>
</ul></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>6</pre></td></tr><tr><td><pre>{0,0,1,1,1,3,2,2,4}</pre></td></tr><tr><td><pre>{1,2,2,3,4,4,4,5,5}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 6</pre></td></tr><tr><td><table><tr><td colspan="2">The graph looks like this:
<pre>
   /\
  /__\
 /\  /\
/__\/__\
</pre></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>12</pre></td></tr><tr><td><pre>{0,1,2,3,4,5,6,7,8,0,3,6,1,4,7}</pre></td></tr><tr><td><pre>{1,2,3,4,5,6,7,8,0,3,6,0,9,10,11}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 3</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>7</pre></td></tr><tr><td><pre>{0,1,2,3,1,2,5,1}</pre></td></tr><tr><td><pre>{1,2,3,4,5,6,6,6}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>27</pre></td></tr><tr><td><pre>{0,1,2,3,0,0,7,6,5,1,8,8,2,11,11,3,7,6,18,18,5,15,15,22,22,0,0,23,4,4,25}</pre></td></tr><tr><td><pre>{1,2,3,4,4,7,6,5,4,8,9,10,11,12,13,14,21,18,19,20,15,16,17,0,4,23,24,24,25,26,26}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 128</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">6)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>67</pre></td></tr><tr><td><pre>{0,1,2,3,1,2,5,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66}</pre></td></tr><tr><td><pre>{1,2,3,4,5,6,6,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 73741817</pre></td></tr><tr><td><table><tr><td colspan="2">The answer is (2^30) % (10^9+7).</td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
